"use strict";(self.webpackChunktvm_cn=self.webpackChunktvm_cn||[]).push([["15646"],{59231:function(n,e,i){i.r(e),i.d(e,{default:()=>u,frontMatter:()=>s,metadata:()=>r,assets:()=>a,toc:()=>d,contentTitle:()=>o});var r=JSON.parse('{"id":"tutorial/tensorIR","title":"TensorIR \u5FEB\u901F\u5165\u95E8","description":"\u5355\u51FB \u6B64\u5904 \u4E0B\u8F7D\u5B8C\u6574\u7684\u793A\u4F8B\u4EE3\u7801","source":"@site/versioned_docs/version-0.12.0/tutorial/09-tensorIR.md","sourceDirName":"tutorial","slug":"/tutorial/tensorIR","permalink":"/docs/tvm-cn/docs/0.12.0/tutorial/tensorIR","draft":false,"unlisted":false,"editUrl":"https://github.com/hyperai/tvm-cn/edit/master/versioned_docs/version-0.12.0/tutorial/09-tensorIR.md","tags":[],"version":"0.12.0","lastUpdatedBy":"sparanoid","lastUpdatedAt":1744717810000,"sidebarPosition":9,"frontMatter":{"title":"TensorIR \u5FEB\u901F\u5165\u95E8"},"sidebar":"tutorialSidebar","previous":{"title":"\u4F7F\u7528 Auto-scheduling \u4F18\u5316\u7B97\u5B50","permalink":"/docs/tvm-cn/docs/0.12.0/tutorial/ops_AutoScheduling"},"next":{"title":"\u4EA4\u53C9\u7F16\u8BD1\u548C RPC","permalink":"/docs/tvm-cn/docs/0.12.0/tutorial/rpc"}}'),t=i("74132"),l=i("21494");let s={title:"TensorIR \u5FEB\u901F\u5165\u95E8"},o="TensorIR \u5FEB\u901F\u5165\u95E8",a={},d=[{value:"IRModule",id:"irmodule",level:2},{value:"\u521B\u5EFA IRModule",id:"\u521B\u5EFA-irmodule",level:2},{value:"\u6784\u5EFA\u5E76\u8FD0\u884C IRModule",id:"\u6784\u5EFA\u5E76\u8FD0\u884C-irmodule",level:2},{value:"\u8F6C\u6362 IRModule",id:"\u8F6C\u6362-irmodule",level:2},{value:"\u8F6C\u6362\u4E3A GPU \u7A0B\u5E8F",id:"\u8F6C\u6362\u4E3A-gpu-\u7A0B\u5E8F",level:3}];function c(n){let e={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.a)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"tensorir-\u5FEB\u901F\u5165\u95E8",children:"TensorIR \u5FEB\u901F\u5165\u95E8"})}),"\n",(0,t.jsx)(e.admonition,{type:"note",children:(0,t.jsxs)(e.p,{children:["\u5355\u51FB ",(0,t.jsx)(e.a,{href:"https://tvm.apache.org/docs/tutorial/tensor_ir_blitz_course.html#sphx-glr-download-tutorial-tensor-ir-blitz-course-py",children:"\u6B64\u5904"})," \u4E0B\u8F7D\u5B8C\u6574\u7684\u793A\u4F8B\u4EE3\u7801"]})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"\u4F5C\u8005"}),"\uFF1A",(0,t.jsx)(e.a,{href:"https://github.com/Hzfengsy",children:"Siyuan Feng"})]}),"\n",(0,t.jsx)(e.p,{children:"TensorIR \u662F\u6DF1\u5EA6\u5B66\u4E60\u9886\u57DF\u7684\u7279\u5B9A\u8BED\u8A00\uFF0C\u4E3B\u8981\u6709\u4E24\u4E2A\u4F5C\u7528\uFF1A"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u5728\u5404\u79CD\u786C\u4EF6\u540E\u7AEF\u8F6C\u6362\u548C\u4F18\u5316\u7A0B\u5E8F\u3002"}),"\n",(0,t.jsx)(e.li,{children:"\u81EA\u52A8 _tensorized_ \u7A0B\u5E8F\u4F18\u5316\u7684\u62BD\u8C61\u3002"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import tvm\nfrom tvm.ir.module import IRModule\nfrom tvm.script import tir as T\nimport numpy as np\n"})}),"\n",(0,t.jsx)(e.h2,{id:"irmodule",children:"IRModule"}),"\n",(0,t.jsx)(e.p,{children:"IRModule \u662F TVM \u7684\u6838\u5FC3\u6570\u636E\u7ED3\u6784\uFF0C\u5B83\u5305\u542B\u6DF1\u5EA6\u5B66\u4E60\u7A0B\u5E8F\uFF0C\u5E76\u4E14\u662F IR \u8F6C\u6362\u548C\u6A21\u578B\u6784\u5EFA\u7684\u57FA\u7840\u3002"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"/img/docs/tlc-pack/web-data/main/images/design/tvm_life_of_irmodule.png",src:i(40892).Z+"",width:"2374",height:"1874"})}),"\n",(0,t.jsxs)(e.p,{children:["\u4E0A\u56FE\u5C55\u793A\u7684\u662F IRModule \u7684\u751F\u547D\u5468\u671F\uFF0C\u5B83\u53EF\u7531 TVMScript \u521B\u5EFA\u3002\u8F6C\u6362 IRModule \u7684\u4E24\u79CD\u4E3B\u8981\u65B9\u6CD5\u662F TensorIR \u7684 schedule \u539F\u8BED\u8F6C\u6362\u548C pass \u8F6C\u6362\u3002\u6B64\u5916\uFF0C\u4E5F\u53EF\u76F4\u63A5\u5BF9 IRModule \u8FDB\u884C\u4E00\u7CFB\u5217\u8F6C\u6362\u3002\u6CE8\u610F\uFF0C\u53EF\u4EE5\u5728",(0,t.jsx)(e.strong,{children:"\u4EFB\u4F55"}),"\u9636\u6BB5\u5C06 IRModule \u6253\u5370\u5230 TVMScript\u3002\u5B8C\u6210\u6240\u6709\u8F6C\u6362\u548C\u4F18\u5316\u540E\uFF0C\u53EF\u5C06 IRModule \u6784\u5EFA\u4E3A\u53EF\u8FD0\u884C\u6A21\u5757\uFF0C\u4ECE\u800C\u90E8\u7F72\u5728\u76EE\u6807\u8BBE\u5907\u4E0A\u3002"]}),"\n",(0,t.jsx)(e.p,{children:"\u57FA\u4E8E TensorIR \u548C IRModule \u7684\u8BBE\u8BA1\uFF0C\u53EF\u521B\u5EFA\u4E00\u79CD\u65B0\u7684\u7F16\u7A0B\u65B9\u6CD5\uFF1A"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"\u57FA\u4E8E Python-AST \u8BED\u6CD5\uFF0C\u7528 TVMScript \u7F16\u5199\u7A0B\u5E8F\u3002"}),"\n",(0,t.jsx)(e.li,{children:"\u4F7F\u7528 Python API \u8F6C\u6362\u548C\u4F18\u5316\u7A0B\u5E8F\u3002"}),"\n",(0,t.jsx)(e.li,{children:"\u4F7F\u7528\u547D\u4EE4\u5F0F\u8F6C\u6362 API \u4EA4\u4E92\u68C0\u67E5\u548C\u63D0\u9AD8\u6027\u80FD\u3002"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\u521B\u5EFA-irmodule",children:"\u521B\u5EFA IRModule"}),"\n",(0,t.jsx)(e.p,{children:"IRModule \u662F TVM IR \u7684\u4E00\u79CD\u53EF\u5F80\u8FD4\u8BED\u6CD5\uFF0C\u53EF\u901A\u8FC7\u7F16\u5199 TVMScript \u6765\u521B\u5EFA\u3002"}),"\n",(0,t.jsxs)(e.p,{children:["\u4E0E\u901A\u8FC7\u5F20\u91CF\u8868\u8FBE\u5F0F\u521B\u5EFA\u8BA1\u7B97\u8868\u8FBE\u5F0F\uFF08",(0,t.jsx)(e.a,{href:"https://tvm.apache.org/docs/tutorial/tensor_expr_get_started.html#tutorial-tensor-expr-get-started",children:"\u4F7F\u7528\u5F20\u91CF\u8868\u8FBE\u5F0F\u64CD\u4F5C\u7B97\u5B50"}),"\uFF09\u4E0D\u540C\uFF0CTensorIR \u5141\u8BB8\u7528\u6237\u901A\u8FC7 TVMScript\uFF08\u4E00\u79CD\u5D4C\u5728 Python AST \u4E2D\u7684\u8BED\u8A00\uFF09\u8FDB\u884C\u7F16\u7A0B\u3002\u65B0\u65B9\u6CD5\u53EF\u4EE5\u7F16\u5199\u590D\u6742\u7684\u7A0B\u5E8F\u5E76\u8FDB\u4E00\u6B65\u8C03\u5EA6\u548C\u4F18\u5316\u3002"]}),"\n",(0,t.jsx)(e.p,{children:"\u4E0B\u9762\u662F\u5411\u91CF\u52A0\u6CD5\u7684\u793A\u4F8B\uFF1A"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'@tvm.script.ir_module\nclass MyModule:\n    @T.prim_func\n    def main(a: T.handle, b: T.handle):\n        # \u6211\u4EEC\u901A\u8FC7 T.handle \u8FDB\u884C\u6570\u636E\u4EA4\u6362\uFF0C\u7C7B\u4F3C\u4E8E\u5185\u5B58\u6307\u9488\n        T.func_attr({"global_symbol": "main", "tir.noalias": True})\n        # \u901A\u8FC7 handle \u521B\u5EFA Buffer\n        A = T.match_buffer(a, (8,), dtype="float32")\n        B = T.match_buffer(b, (8,), dtype="float32")\n        for i in range(8):\n            # block \u662F\u9488\u5BF9\u8BA1\u7B97\u7684\u62BD\u8C61\n            with T.block("B"):\n                # \u5B9A\u4E49\u4E00\u4E2A\u7A7A\u95F4\uFF08\u53EF\u5E76\u884C\uFF09block \u8FED\u4EE3\u5668\uFF0C\u5E76\u4E14\u5C06\u5B83\u7684\u503C\u7ED1\u5B9A\u6210 i\n                vi = T.axis.spatial(8, i)\n                B[vi] = A[vi] + 1.0\n\nir_module = MyModule\nprint(type(ir_module))\nprint(ir_module.script())\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u8F93\u51FA\u7ED3\u679C\uFF1A"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'<class \'tvm.ir.module.IRModule\'>\n# from tvm.script import tir as T\n@tvm.script.ir_module\nclass Module:\n    @T.prim_func\n    def main(A: T.Buffer[8, "float32"], B: T.Buffer[8, "float32"]) -> None:\n        # function attr dict\n        T.func_attr({"global_symbol": "main", "tir.noalias": True})\n        # body\n        # with T.block("root")\n        for i in T.serial(8):\n            with T.block("B"):\n                vi = T.axis.spatial(8, i)\n                T.reads(A[vi])\n                T.writes(B[vi])\n                B[vi] = A[vi] + T.float32(1)\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u6B64\u5916\uFF0C\u6211\u4EEC\u8FD8\u53EF\u4EE5\u4F7F\u7528\u5F20\u91CF\u8868\u8FBE\u5F0F DSL \u7F16\u5199\u7B80\u5355\u7684\u8FD0\u7B97\u7B26\uFF0C\u5E76\u5C06\u5B83\u4EEC\u8F6C\u6362\u4E3A IRModule\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'from tvm import te\n\nA = te.placeholder((8,), dtype="float32", name="A")\nB = te.compute((8,), lambda *i: A(*i) + 1.0, name="B")\nfunc = te.create_prim_func([A, B])\nir_module_from_te = IRModule({"main": func})\nprint(ir_module_from_te.script())\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u8F93\u51FA\u7ED3\u679C\uFF1A"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'# from tvm.script import tir as T\n@tvm.script.ir_module\nclass Module:\n    @T.prim_func\n    def main(A: T.Buffer[8, "float32"], B: T.Buffer[8, "float32"]) -> None:\n        # function attr dict\n        T.func_attr({"global_symbol": "main", "tir.noalias": True})\n        # body\n        # with T.block("root")\n        for i0 in T.serial(8):\n            with T.block("B"):\n                i0_1 = T.axis.spatial(8, i0)\n                T.reads(A[i0_1])\n                T.writes(B[i0_1])\n                B[i0_1] = A[i0_1] + T.float32(1)\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u6784\u5EFA\u5E76\u8FD0\u884C-irmodule",children:"\u6784\u5EFA\u5E76\u8FD0\u884C IRModule"}),"\n",(0,t.jsx)(e.p,{children:"\u53EF\u5C06 IRModule \u6784\u5EFA\u4E3A\u7279\u5B9A target \u540E\u7AEF\u7684\u53EF\u8FD0\u884C\u6A21\u5757\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'mod = tvm.build(ir_module, target="llvm")  # CPU \u540E\u7AEF\u7684\u6A21\u5757\nprint(type(mod))\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u8F93\u51FA\u7ED3\u679C\uFF1A"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"<class 'tvm.driver.build_module.OperatorModule'>\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u51C6\u5907\u8F93\u5165\u6570\u7EC4\u548C\u8F93\u51FA\u6570\u7EC4\uFF0C\u7136\u540E\u8FD0\u884C\u6A21\u5757\uFF1A"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'a = tvm.nd.array(np.arange(8).astype("float32"))\nb = tvm.nd.array(np.zeros((8,)).astype("float32"))\nmod(a, b)\nprint(a)\nprint(b)\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u8F93\u51FA\u7ED3\u679C\uFF1A"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"[0. 1. 2. 3. 4. 5. 6. 7.]\n[1. 2. 3. 4. 5. 6. 7. 8.]\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u8F6C\u6362-irmodule",children:"\u8F6C\u6362 IRModule"}),"\n",(0,t.jsxs)(e.p,{children:["IRModule \u662F\u7A0B\u5E8F\u4F18\u5316\u7684\u6838\u5FC3\u6570\u636E\u7ED3\u6784\uFF0C\u53EF\u901A\u8FC7 ",(0,t.jsx)(e.code,{children:"Schedule"})," \u8FDB\u884C\u8F6C\u6362\u3002schedule \u5305\u542B\u591A\u4E2A primitive \u65B9\u6CD5\u6765\u4EA4\u4E92\u5730\u8F6C\u6362\u7A0B\u5E8F\u3002\u6BCF\u4E2A primitive \u90FD\u4EE5\u7279\u5B9A\u65B9\u5F0F\u5BF9\u7A0B\u5E8F\u8FDB\u884C\u8F6C\u6362\uFF0C\u4ECE\u800C\u4F18\u5316\u6027\u80FD\u3002"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"/img/docs/tlc-pack/web-data/main/images/design/tvm_tensor_ir_opt_flow.png",src:i(91407).Z+"",width:"4170",height:"2264"})}),"\n",(0,t.jsx)(e.p,{children:"\u4E0A\u56FE\u662F\u4F18\u5316\u5F20\u91CF\u7A0B\u5E8F\u7684\u5178\u578B\u5DE5\u4F5C\u6D41\u7A0B\u3002\u9996\u5148\uFF0C\u7528 TVMScript \u6216\u5F20\u91CF\u8868\u8FBE\u5F0F\u521B\u5EFA\u4E00\u4E2A\u521D\u59CB IRModule\uFF0C\u7136\u540E\u5728\u8FD9\u4E2A\u521D\u59CB IRModule \u4E0A\u521B\u5EFA schedule\u3002\u63A5\u4E0B\u6765\uFF0C\u4F7F\u7528\u4E00\u7CFB\u5217\u8C03\u5EA6\u539F\u8BED\u6765\u63D0\u9AD8\u6027\u80FD\u3002\u6700\u540E\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5C06\u5176\u964D\u4F4E\u5E76\u6784\u5EFA\u6210\u4E00\u4E2A\u53EF\u8FD0\u884C\u6A21\u5757\u3002"}),"\n",(0,t.jsxs)(e.p,{children:["\u4E0A\u9762\u53EA\u6F14\u793A\u4E86\u4E00\u4E2A\u7B80\u5355\u7684\u8F6C\u6362\u3002\u9996\u5148\uFF0C\u5728\u8F93\u5165 ",(0,t.jsx)(e.em,{children:"ir_module"})," \u4E0A\u521B\u5EFA schedule\uFF1A"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"sch = tvm.tir.Schedule(ir_module)\nprint(type(sch))\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u8F93\u51FA\u7ED3\u679C\uFF1A"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"<class 'tvm.tir.schedule.schedule.Schedule'>\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5C06\u5D4C\u5957\u5FAA\u73AF\u5C55\u5F00\u6210 3 \u4E2A\u5FAA\u73AF\uFF0C\u5E76\u6253\u5370\u7ED3\u679C\uFF1A"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'# \u901A\u8FC7\u540D\u5B57\u83B7\u53D6 block\nblock_b = sch.get_block("B")\n# \u83B7\u53D6\u5305\u56F4 block \u7684\u5FAA\u73AF\n(i,) = sch.get_loops(block_b)\n# \u5C55\u5F00\u5D4C\u5957\u5FAA\u73AF\ni_0, i_1, i_2 = sch.split(i, factors=[2, 2, 2])\nprint(sch.mod.script())\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u8F93\u51FA\u7ED3\u679C\uFF1A"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'# from tvm.script import tir as T\n@tvm.script.ir_module\nclass Module:\n    @T.prim_func\n    def main(A: T.Buffer[8, "float32"], B: T.Buffer[8, "float32"]) -> None:\n        # function attr dict\n        T.func_attr({"global_symbol": "main", "tir.noalias": True})\n        # body\n        # with T.block("root")\n        for i_0, i_1, i_2 in T.grid(2, 2, 2):\n            with T.block("B"):\n                vi = T.axis.spatial(8, i_0 * 4 + i_1 * 2 + i_2)\n                T.reads(A[vi])\n                T.writes(B[vi])\n                B[vi] = A[vi] + T.float32(1)\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u8FD8\u53EF\u5BF9\u5FAA\u73AF\u91CD\u65B0\u6392\u5E8F\u3002\u4F8B\u5982\uFF0C\u5C06\u5FAA\u73AF ",(0,t.jsx)(e.em,{children:"i_2"})," \u79FB\u5230 ",(0,t.jsx)(e.em,{children:"i_1"})," \u4E4B\u5916\uFF1A"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"sch.reorder(i_0, i_2, i_1)\nprint(sch.mod.script())\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u8F93\u51FA\u7ED3\u679C\uFF1A"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'# from tvm.script import tir as T\n@tvm.script.ir_module\nclass Module:\n    @T.prim_func\n    def main(A: T.Buffer[8, "float32"], B: T.Buffer[8, "float32"]) -> None:\n        # function attr dict\n        T.func_attr({"global_symbol": "main", "tir.noalias": True})\n        # body\n        # with T.block("root")\n        for i_0, i_2, i_1 in T.grid(2, 2, 2):\n            with T.block("B"):\n                vi = T.axis.spatial(8, i_0 * 4 + i_1 * 2 + i_2)\n                T.reads(A[vi])\n                T.writes(B[vi])\n                B[vi] = A[vi] + T.float32(1)\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u8F6C\u6362\u4E3A-gpu-\u7A0B\u5E8F",children:"\u8F6C\u6362\u4E3A GPU \u7A0B\u5E8F"}),"\n",(0,t.jsx)(e.p,{children:"\u8981\u5728 GPU \u4E0A\u90E8\u7F72\u6A21\u578B\u5FC5\u987B\u8FDB\u884C\u7EBF\u7A0B\u7ED1\u5B9A\u3002\u5E78\u8FD0\u7684\u662F\uFF0C\u4E5F\u53EF\u4EE5\u7528\u539F\u8BED\u6765\u589E\u91CF\u8F6C\u6362\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'sch.bind(i_0, "blockIdx.x")\nsch.bind(i_2, "threadIdx.x")\nprint(sch.mod.script())\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u8F93\u51FA\u7ED3\u679C\uFF1A"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'# from tvm.script import tir as T\n@tvm.script.ir_module\nclass Module:\n    @T.prim_func\n    def main(A: T.Buffer[8, "float32"], B: T.Buffer[8, "float32"]) -> None:\n        # function attr dict\n        T.func_attr({"global_symbol": "main", "tir.noalias": True})\n        # body\n        # with T.block("root")\n        for i_0 in T.thread_binding(2, thread="blockIdx.x"):\n            for i_2 in T.thread_binding(2, thread="threadIdx.x"):\n                for i_1 in T.serial(2):\n                    with T.block("B"):\n                        vi = T.axis.spatial(8, i_0 * 4 + i_1 * 2 + i_2)\n                        T.reads(A[vi])\n                        T.writes(B[vi])\n                        B[vi] = A[vi] + T.float32(1)\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u7ED1\u5B9A\u7EBF\u7A0B\u540E\uFF0C\u7528 ",(0,t.jsx)(e.code,{children:"cuda"})," \u540E\u7AEF\u6765\u6784\u5EFA IRModule\uFF1A"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'ctx = tvm.cuda(0)\ncuda_mod = tvm.build(sch.mod, target="cuda")\ncuda_a = tvm.nd.array(np.arange(8).astype("float32"), ctx)\ncuda_b = tvm.nd.array(np.zeros((8,)).astype("float32"), ctx)\ncuda_mod(cuda_a, cuda_b)\nprint(cuda_a)\nprint(cuda_b)\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u8F93\u51FA\u7ED3\u679C\uFF1A"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"[0. 1. 2. 3. 4. 5. 6. 7.]\n[1. 2. 3. 4. 5. 6. 7. 8.]\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"https://tvm.apache.org/docs/_downloads/5c7000b5aef924e29ec975ec3002ea03/tensor_ir_blitz_course.py",children:"\u4E0B\u8F7D Python \u6E90\u4EE3\u7801\uFF1Atensor_ir_blitz_course.py"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"https://tvm.apache.org/docs/_downloads/c9bb7875c6ca5b2da162e177d3c9aac0/tensor_ir_blitz_course.ipynb",children:"\u4E0B\u8F7D Jupyter Notebook\uFF1Atensor_ir_blitz_course.ipynb"})})]})}function u(n={}){let{wrapper:e}={...(0,l.a)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},40892:function(n,e,i){i.d(e,{Z:function(){return r}});let r=i.p+"assets/images/tvm_life_of_irmodule-b9109efc9d6250e67e272c5d66e187f6.png"},91407:function(n,e,i){i.d(e,{Z:function(){return r}});let r=i.p+"assets/images/tvm_tensor_ir_opt_flow-e13b7851b32b74cb5b329677ec0f6ef5.png"},21494:function(n,e,i){i.d(e,{Z:function(){return o},a:function(){return s}});var r=i(39546);let t={},l=r.createContext(t);function s(n){let e=r.useContext(l);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:s(n.components),r.createElement(l.Provider,{value:e},n.children)}}}]);