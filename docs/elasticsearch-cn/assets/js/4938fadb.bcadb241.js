"use strict";(self.webpackChunkelasticsearch_doc=self.webpackChunkelasticsearch_doc||[]).push([[1010],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>k});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),i=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},p=function(e){var n=i(e.components);return r.createElement(l.Provider,{value:n},e.children)},u="mdxType",g={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=i(t),d=a,k=u["".concat(l,".").concat(d)]||u[d]||g[d]||o;return t?r.createElement(k,c(c({ref:n},p),{},{components:t})):r.createElement(k,c({ref:n},p))}));function k(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,c=new Array(o);c[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[u]="string"==typeof e?e:a,c[1]=s;for(var i=2;i<o;i++)c[i]=t[i];return r.createElement.apply(null,c)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},2026:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>i});var r=t(7462),a=(t(7294),t(3905));const o={},c="\u4f7f\u7528\u805a\u5408\u5206\u6790\u7ed3\u679c",s={unversionedId:"getting_started/aggregations",id:"getting_started/aggregations",title:"\u4f7f\u7528\u805a\u5408\u5206\u6790\u7ed3\u679c",description:"Elasticsearch \u805a\u5408\u80fd\u8ba9\u4f60\u83b7\u53d6\u641c\u7d22\u7ed3\u679c\u7684\u5143\u4fe1\u606f\uff0c\u5e76\u56de\u7b54\u8fd9\u4e9b\u95ee\u9898\uff0c\u5982\u201c\u5fb7\u514b\u8428\u65af\u5dde\u6709\u591a\u5c11\u8d26\u6237\u6240\u6709\u8005\uff1f\u201d\u6216\u201c\u7530\u7eb3\u897f\u5dde\u7684\u8d26\u6237\u5e73\u5747\u4f59\u989d\u662f\u591a\u5c11\uff1f\u201d\u3002\u4f60\u53ef\u4ee5\u5728\u4e00\u4e2a\u8bf7\u6c42\u4e2d\u641c\u7d22\u6587\u6863\u3001\u8fc7\u6ee4\u547d\u4e2d\u4ee5\u53ca\u4f7f\u7528\u805a\u5408\u5206\u6790\u7ed3\u679c\u3002",source:"@site/docs/getting_started/aggregations.md",sourceDirName:"getting_started",slug:"/getting_started/aggregations",permalink:"/docs/elasticsearch-cn/getting_started/aggregations",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u5f00\u59cb\u641c\u7d22",permalink:"/docs/elasticsearch-cn/getting_started/search"},next:{title:"\u4f55\u53bb\u4f55\u4ece",permalink:"/docs/elasticsearch-cn/getting_started/nextstep"}},l={},i=[],p={toc:i};function u(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u4f7f\u7528\u805a\u5408\u5206\u6790\u7ed3\u679c"},"\u4f7f\u7528\u805a\u5408\u5206\u6790\u7ed3\u679c"),(0,a.kt)("p",null,"Elasticsearch \u805a\u5408\u80fd\u8ba9\u4f60\u83b7\u53d6\u641c\u7d22\u7ed3\u679c\u7684\u5143\u4fe1\u606f\uff0c\u5e76\u56de\u7b54\u8fd9\u4e9b\u95ee\u9898\uff0c\u5982\u201c\u5fb7\u514b\u8428\u65af\u5dde\u6709\u591a\u5c11\u8d26\u6237\u6240\u6709\u8005\uff1f\u201d\u6216\u201c\u7530\u7eb3\u897f\u5dde\u7684\u8d26\u6237\u5e73\u5747\u4f59\u989d\u662f\u591a\u5c11\uff1f\u201d\u3002\u4f60\u53ef\u4ee5\u5728\u4e00\u4e2a\u8bf7\u6c42\u4e2d\u641c\u7d22\u6587\u6863\u3001\u8fc7\u6ee4\u547d\u4e2d\u4ee5\u53ca\u4f7f\u7528\u805a\u5408\u5206\u6790\u7ed3\u679c\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\uff0c\u4ee5\u4e0b\u7684\u8bf7\u6c42\u4f7f\u7528\u4e00\u4e2a\u8bcd\u8bed\u805a\u5408\u5206\u7ec4\u5728\u94f6\u884c\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"bank"),"\uff09\u7d22\u5f15\u4e2d\u6309\u5dde\u5bf9\u6240\u6709\u8d26\u6237\u5206\u7ec4\uff0c\u5e76\u6309\u964d\u5e8f\u8fd4\u56de\u8d26\u6237\u6700\u591a\u7684\u5341\u4e2a\u5dde\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'GET /bank/_search\n{\n  "size": 0,\n  "aggs": {\n    "group_by_state": {\n      "terms": {\n        "field": "state.keyword"\n      }\n    }\n  }\n}\n')),(0,a.kt)("p",null,"\u54cd\u5e94\u4e2d\u7684\u6876\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"bucket"),"\uff09\u662f\u5dde\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"state"),"\uff09\u5b57\u6bb5\u7684\u503c\u3002",(0,a.kt)("inlineCode",{parentName:"p"},"doc_count")," \u663e\u793a\u6bcf\u4e2a\u5dde\u7684\u8d26\u6237\u6570\u91cf\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u770b\u5230 ID\uff08\u7231\u8fbe\u8377\u5dde\uff09\u6709 27 \u4e2a\u8d26\u6237\u3002\u7531\u4e8e\u8fd9\u4e2a\u8bf7\u6c42\u8bbe\u7f6e ",(0,a.kt)("inlineCode",{parentName:"p"},"size=0"),"\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u53ea\u5305\u542b\u805a\u5408\u7ed3\u679c\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "took": 29,\n  "timed_out": false,\n  "_shards": {\n    "total": 5,\n    "successful": 5,\n    "skipped" : 0,\n    "failed": 0\n  },\n  "hits" : {\n     "total" : {\n        "value": 1000,\n        "relation": "eq"\n     },\n    "max_score" : null,\n    "hits" : [ ]\n  },\n  "aggregations" : {\n    "group_by_state" : {\n      "doc_count_error_upper_bound": 20,\n      "sum_other_doc_count": 770,\n      "buckets" : [ {\n        "key" : "ID",\n        "doc_count" : 27\n      }, {\n        "key" : "TX",\n        "doc_count" : 27\n      }, {\n        "key" : "AL",\n        "doc_count" : 25\n      }, {\n        "key" : "MD",\n        "doc_count" : 25\n      }, {\n        "key" : "TN",\n        "doc_count" : 23\n      }, {\n        "key" : "MA",\n        "doc_count" : 21\n      }, {\n        "key" : "NC",\n        "doc_count" : 21\n      }, {\n        "key" : "ND",\n        "doc_count" : 21\n      }, {\n        "key" : "ME",\n        "doc_count" : 20\n      }, {\n        "key" : "MO",\n        "doc_count" : 20\n      } ]\n    }\n  }\n}\n')),(0,a.kt)("p",null,"\u4f60\u53ef\u4ee5\u5408\u5e76\u805a\u5408\u6765\u6784\u5efa\u66f4\u590d\u6742\u7684\u6570\u636e\u6458\u8981\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b\u8bf7\u6c42\u5728\u524d\u4e00\u4e2a\u6309\u5dde\u5206\u7ec4\uff08",(0,a.kt)("inlineCode",{parentName:"p"},"group_by_state"),"\uff09\u805a\u5408\u5d4c\u5957\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"avg")," \u805a\u5408\uff0c\u4ee5\u8ba1\u7b97\u6bcf\u4e2a\u5dde\u7684\u5e73\u5747\u8d26\u6237\u4f59\u989d\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'GET /bank/_search\n{\n  "size": 0,\n  "aggs": {\n    "group_by_state": {\n      "terms": {\n        "field": "state.keyword"\n      },\n      "aggs": {\n        "average_balance": {\n          "avg": {\n            "field": "balance"\n          }\n        }\n      }\n    }\n  }\n}\n')),(0,a.kt)("p",null,"\u4f60\u53ef\u4ee5\u4f7f\u7528\u5d4c\u5957\u805a\u5408\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f\uff08\u901a\u8fc7\u6307\u5b9a\u8bcd\u8bed\u805a\u5408\u987a\u5e8f\uff09\uff0c\u800c\u4e0d\u662f\u6309\u8ba1\u6570\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'GET /bank/_search\n{\n  "size": 0,\n  "aggs": {\n    "group_by_state": {\n      "terms": {\n        "field": "state.keyword",\n        "order": {\n          "average_balance": "desc"\n        }\n      },\n      "aggs": {\n        "average_balance": {\n          "avg": {\n            "field": "balance"\n          }\n        }\n      }\n    }\n  }\n}\n')),(0,a.kt)("p",null,"\u9664\u4e86\u8fd9\u4e9b\u57fa\u672c\u7684\u6876\u548c\u5ea6\u91cf\u805a\u5408\u5916\uff0cElasticsearch \u63d0\u4f9b\u4e86\u7279\u5b9a\u7684\u805a\u5408\u7528\u4e8e\u64cd\u4f5c\u591a\u4e2a\u5b57\u6bb5\u548c\u5206\u6790\u7279\u5b9a\u7c7b\u578b\u6570\u636e\uff0c\u5982\u65e5\u671f\u3001IP \u5730\u5740\u4ee5\u53ca\u5730\u7406\u6570\u636e\u3002\u4f60\u8fd8\u53ef\u4ee5\u5c06\u5355\u4e2a\u805a\u5408\u7684\u7ed3\u679c\u8f93\u5165\u7ba1\u9053\u805a\u5408\u7528\u4e8e\u8fdb\u4e00\u6b65\u7684\u5206\u6790\u3002"),(0,a.kt)("p",null,"\u805a\u5408\u63d0\u4f9b\u7684\u6838\u5fc3\u5206\u6790\u80fd\u529b\u652f\u6301\u9ad8\u7ea7\u7279\u6027\uff0c\u5982\u4f7f\u7528\u673a\u5668\u5b66\u4e60\u6765\u68c0\u6d4b\u5f02\u5e38\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("a",{parentName:"p",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started-aggregations.html"},"\u539f\u6587\u94fe\u63a5"))))}u.isMDXComponent=!0}}]);